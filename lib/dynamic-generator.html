<script src="data:text/javascript;base64,IWZ1bmN0aW9uKGdsb2JhbCl7DQogIC8qDQogICAqIGR5bmFtaWMtZ2VuZXJhdG9yDQogICAqIHYxLjQuMA0KICAgKi8NCiAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLGZ1bmN0aW9uKCl7DQogICAgdmFyIHNjcmlwdHMgPSBbXQ0KICAgIGZ1bmN0aW9uIHB1c2hlcihpdGVtLGluZGV4KXsNCiAgICAgIHNjcmlwdHMucHVzaCh7DQogICAgICAgIGNvZGU6aXRlbS5pbm5lckhUTUwsDQogICAgICAgIEVsZW1lbnQ6aXRlbQ0KICAgICAgfSkNCiAgICB9DQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0W3R5cGU9InRleHQvZ2VuZXJhdG9yIl1bc3JjXScpLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7DQogICAgICBmZXRjaChpdGVtLmdldEF0dHJpYnV0ZSgnc3JjJykpDQogICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkgew0KICAgICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpDQogICAgICB9KQ0KICAgICAgLnRoZW4oZnVuY3Rpb24oZGF0YSkgew0KICAgICAgICBzY3JpcHRzLnB1c2goew0KICAgICAgICAgIGNvZGU6ZGF0YSwNCiAgICAgICAgICBFbGVtZW50OmRvY3VtZW50DQogICAgICAgIH0pDQogICAgICB9KQ0KICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpDQogICAgfSkNCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHRbdHlwZT0idGV4dC9nZW5lcmF0b3IiXTpub3QoW3NyY10pJykuZm9yRWFjaChwdXNoZXIpDQogICAgc2NyaXB0cy5mb3JFYWNoKA0KICAgICAgZnVuY3Rpb24oaXRlbSl7DQogICAgICAgIGl0ZW0uY29kZSA9IGl0ZW0uY29kZS5yZXBsYWNlKC9cL1wqLipcKlwvL2csJycpDQogICAgICAgIGl0ZW0uY29kZS5zcGxpdCgvO3xcbi8pLmZvckVhY2goDQogICAgICAgICAgZnVuY3Rpb24oaXRlbTIpew0KICAgICAgICAgICAgY29uc3QgY29tbWFuZHMgPSB7DQogICAgICAgICAgICAgIGluY2x1ZGU6ZnVuY3Rpb24odGV4dCxlbGVtZW50KXsNCiAgICAgICAgICAgICAgICB0ZXh0ID0gL15bXCJcJ10uK1tcIlwnXSQvLnRlc3QodGV4dFswXSkgPyB0ZXh0WzBdLnJlcGxhY2UoL15bXCJcJ10vLCcnKS5yZXBsYWNlKC9bXCJcJ10kLywnJykgOiBnbG9iYWxbdGV4dFswXV0NCiAgICAgICAgICAgICAgICBmZXRjaCh0ZXh0KQ0KICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7DQogICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKXsNCiAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmViZWdpbicsIGRhdGEpDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcikNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgc2hvdzpmdW5jdGlvbih0ZXh0LGVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICB0ZXh0ID0gL15bXCJcJ10uK1tcIlwnXSQvLnRlc3QodGV4dFswXSkgPyB0ZXh0WzBdLnJlcGxhY2UoL15bXCJcJ10vLCcnKS5yZXBsYWNlKC9bXCJcJ10kLywnJykgOiBnbG9iYWxbdGV4dFswXV0NCiAgICAgICAgICAgICAgICBlbGVtZW50Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlYmVnaW4nLCB0ZXh0KQ0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB2YXI6ZnVuY3Rpb24obGVzdCkgew0KICAgICAgICAgICAgICAgIGlmKCFsZXN0Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGBVbmV4cGVjdGVkIGVuZCBvZiBpbnB1dGApDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmKGxlc3RbMF09PSdzZXQnJiZsZXN0Lmxlbmd0aD09NCYmZ2xvYmFsW2xlc3RbMV1dKSB7DQogICAgICAgICAgICAgICAgICBnbG9iYWxbbGVzdFsxXV0gPSBsZXN0WzNdDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmKGxlc3RbMF09PSdjcmVhdGUnJiZsZXN0Lmxlbmd0aD49MiYmbGVzdC5sZW5ndGg8PTQmJnR5cGVvZiBnbG9iYWxbbGVzdFsxXV09PT0ndW5kZWZpbmVkJykgew0KICAgICAgICAgICAgICAgICAgZ2xvYmFsW2xlc3RbMV1dID0gbGVzdFszXSA/PyB1bmRlZmluZWQNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGBVbmV4cGVjdGVkIHRva2VuICcke2xlc3RbMV19J2ApDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAnLy8nOmZ1bmN0aW9uKCl7fQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYoISgvXlwvXC8vLnRlc3QoaXRlbTIuc3BsaXQoL1xzKy8pWzBdKSkpIHsNCiAgICAgICAgICAgICAgY29uc3QgWyxjb21tYW5kLCAuLi5sZXN0XSA9IGl0ZW0yLnNwbGl0KC9ccysvKQ0KICAgICAgICAgICAgICBpZihjb21tYW5kc1tjb21tYW5kXSkgew0KICAgICAgICAgICAgICAgIGNvbW1hbmRzW2NvbW1hbmRdKGxlc3QsaXRlbS5FbGVtZW50KQ0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFjb21tYW5kKSB7fSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoYCR7Y29tbWFuZH0gaXMgbm90IGRlZmluZWRgKQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICApDQogICAgICB9DQogICAgKQ0KICB9KQ0KfSh0aGlzKQ=="></script>
